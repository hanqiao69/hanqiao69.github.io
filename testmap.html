<!DOCTYPE html>
<meta charset="utf-8">
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
</head>
	<!--script src="https://d3js.org/d3.v3.min.js"></script>
	<script src="https://d3js.org/topojson.v1.min.js"></script>
	<script src="https://datamaps.github.io/scripts/datamaps.world.min.js?v=1"></script-->
	<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
	<script src="/Users/qiao/datamaps/dist/datamaps.world.min.js"></script>
	<div id="container" style="position: relative; width: 500px; height: 300px;"></div>
<body>
	<p> STUB </p>
	<script>
var map = new Datamap({

        scope: 'world',
         element: document.getElementById('container'),

        projection: 'mercator',
        height: 600,
        width: 700,
        fills: {
          present: '#cb4435',
          notpresent: '#333',
          gt50: 'red'
        },

        
        data: {
          USA: {fillKey: 'present' },
          RUS: {fillKey: 'notpresent' },
          CAN: {fillKey: 'present' },
          BRA: {fillKey: 'notpresent' },
          ARG: {fillKey: 'notpresent'},
          COL: {fillKey: 'notpresent' },
          AUS: {fillKey: 'notpresent' },
          ZAF: {fillKey: 'notpresent' },
          ESP: {fillKey: 'present'}
          //EUR: {fillkey: 'present'}     
        }
      });

  
      
    
        var count1 = 100;
      var count2 = 200;
      var count3 = 300;

      //current_city
      //current_state

//https://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+//Mountain+View,+CA&key=AIzaSyBg5biu2ul99Vsk3xNU1ZAZ3QlTw-T-IaA

var blah;

function handleLookUp(blah) {

    var url = "https://maps.googleapis.com/maps/api/geocode/json?address=";
    url = url + "<%= user.current_city %>" + "," + "<%= user.current_state %>" + "&key=AIzaSyBg5biu2ul99Vsk3xNU1ZAZ3QlTw-T-IaA";
    req = new XMLHttpRequest();
    req.open('GET', url, true);
    req.addEventListener('load', handleResponse);
    req.send();

} 
function handleResponse(data){

  if(this.status >= 200 && this.status < 400) {
  }
}

       //bubbles, custom popup on hover template
     map.bubbles([

           {name:  "<%= user.first_name %> <%= user.last_name %>", latitude:40.9175771+ Math.random()*5, longitude: -73.70027209999999 + Math.random()*5, radius: Math.random()*18, fillKey: 'gt50'},
     ], {
       popupTemplate: function(geo, data) {
         return "<div class='hoverinfo'>" + data.name + "</div>";
       }
     });
  </script>
</body>